<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบบูรณาการงานสวนพฤกษศาสตร์โรงเรียน</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
        }
        /* Custom styles for prose-like content in results */
        .prose-purple p {
            margin-bottom: 1em;
        }
        .prose-purple strong {
            font-weight: 700;
            color: #6B21A8; /* Tailwind purple-800 */
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-purple-50 to-purple-100 p-4 sm:p-8 text-gray-800">
    <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-6 sm:p-10">
        <div class="flex justify-center items-center space-x-4 mb-6">
            <img
                src="https://img2.pic.in.th/pic/-..1.png"
                alt="โลโก้ที่ 1"
                class="w-20 h-20 object-contain rounded-lg"
                onerror="this.onerror=null;this.src='https://placehold.co/80x80/cccccc/ffffff?text=โลโก้1';"
            />
            <img
                src="https://img2.pic.in.th/pic/logo-HDR.png"
                alt="โลโก้ที่ 2"
                class="w-20 h-20 object-contain rounded-lg"
                onerror="this.onerror=null;this.src='https://placehold.co/80x80/cccccc/ffffff?text=โลโก้2';"
            />
        </div>

        <h1 class="text-2xl sm:text-3xl font-extrabold text-center text-purple-800 mb-4">
            งานสวนพฤกษศาสตร์โรงเรียน 
        </h1>
        <h2 class="text-2xl sm:text-3xl font-extrabold text-center text-purple-800 mb-4">
            โรงเรียนหางดงรัฐราษฎร์อุปถัมภ์
        </h2>
        <h3 class="text-3xl sm:text-4xl font-extrabold text-center text-purple-700 mb-6">
            ระบบบูรณาการลำดับการเรียนรู้
        </h3>
        <p class="text-center text-lg text-gray-600 mb-8">
            เครื่องมือช่วยในการค้นหาแนวทางการบูรณาการงานสวนพฤกษศาสตร์โรงเรียนเข้ากับการเรียนการสอน
        </p>

        <form id="integrationForm" class="space-y-6 mb-10">
            <div>
                <label for="gradeLevel" class="block text-lg font-medium text-gray-700 mb-2">
                    ระดับชั้นที่สอน:
                </label>
                <select
                    id="gradeLevel"
                    class="mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-purple-500 focus:border-purple-500 sm:text-base"
                    required
                >
                    <option value="">เลือกระดับชั้น</option>
                    <option value="ประถมศึกษาปีที่ 1">ประถมศึกษาปีที่ 1</option>
                    <option value="ประถมศึกษาปีที่ 2">ประถมศึกษาปีที่ 2</option>
                    <option value="ประถมศึกษาปีที่ 3">ประถมศึกษาปีที่ 3</option>
                    <option value="ประถมศึกษาปีที่ 4">ประถมศึกษาปีที่ 4</option>
                    <option value="ประถมศึกษาปีที่ 5">ประถมศึกษาปีที่ 5</option>
                    <option value="ประถมศึกษาปีที่ 6">ประถมศึกษาปีที่ 6</option>
                    <option value="มัธยมศึกษาปีที่ 1">มัธยมศึกษาปีที่ 1</option>
                    <option value="มัธยมศึกษาปีที่ 2">มัธยมศึกษาปีที่ 2</option>
                    <option value="มัธยมศึกษาปีที่ 3">มัธยมศึกษาปีที่ 3</option>
                    <option value="มัธยมศึกษาปีที่ 4">มัธยมศึกษาปีที่ 4</option>
                    <option value="มัธยมศึกษาปีที่ 5">มัธยมศึกษาปีที่ 5</option>
                    <option value="มัธยมศึกษาปีที่ 6">มัธยมศึกษาปีที่ 6</option>
                    <option value="ปวช.">ปวช.</option>
                    <option value="ปวส.">ปวส.</option>
                </select>
            </div>

            <div>
                <label for="subject" class="block text-lg font-medium text-gray-700 mb-2">
                    วิชาที่สอน:
                </label>
                <select
                    id="subject"
                    class="mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-purple-500 focus:border-purple-500 sm:text-base"
                    required
                >
                    <option value="">เลือกวิชา</option>
                    <option value="วิทยาศาสตร์">วิทยาศาสตร์</option>
                    <option value="คณิตศาสตร์">คณิตศาสตร์</option>
                    <option value="ภาษาไทย">ภาษาไทย</option>
                    <option value="สังคมศึกษา">สังคมศึกษา</option>
                    <option value="ศิลปะ">ศิลปะ</option>
                    <option value="สุขศึกษาและพลศึกษา">สุขศึกษาและพลศึกษา</option>
                    <option value="การงานอาชีพ">การงานอาชีพ</option>
                    <option value="ภาษาต่างประเทศ">ภาษาต่างประเทศ</option>
                    <option value="บูรณาการ">บูรณาการ</option>
                </select>
            </div>

            <div>
                <label for="topic" class="block text-lg font-medium text-gray-700 mb-2">
                    เรื่องที่สอน / หัวข้อที่ต้องการบูรณาการ:
                </label>
                <textarea
                    id="topic"
                    rows="4"
                    class="mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-purple-500 focus:border-purple-500 sm:text-base"
                    placeholder="เช่น การเจริญเติบโตของพืช, ความสัมพันธ์ของสิ่งมีชีวิตในระบบนิเวศ, ประวัติชุมชนท้องถิ่น"
                    required
                ></textarea>
            </div>

            <p id="errorMessage" class="text-red-600 text-center text-sm hidden"></p>

            <button
                type="submit"
                id="submitButton"
                class="w-full flex justify-center py-3 px-6 border border-transparent rounded-md shadow-sm text-lg font-semibold text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transition duration-300 ease-in-out transform hover:scale-105"
            >
                <span id="buttonText">ประมวลผลการบูรณาการ</span>
                <svg id="loadingSpinner" class="animate-spin h-6 w-6 text-white hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
            </button>
        </form>

        <div id="resultsContainer" class="mt-10 hidden">
            <h2 class="text-2xl sm:text-3xl font-bold text-purple-700 mb-6 text-center">
                ผลการประมวลผลการบูรณาการ
            </h2>
            <p class="text-lg text-gray-700 mb-4">
                <span class="font-semibold">ระดับชั้น:</span> <span id="displayGradeLevel"></span>
            </p>
            <p class="text-lg text-gray-700 mb-4">
                <span class="font-semibold">วิชาที่สอน:</span> <span id="displaySubject"></span>
            </p>
            <p class="text-lg text-gray-700 mb-6">
                <span class="font-semibold">เรื่องที่สอน:</span> <span id="displayTopic"></span>
            </p>
            <div id="resultsContent">
                </div>
        </div>
    </div>

    <div class="max-w-4xl mx-auto text-center mt-12 p-6 text-gray-600">
        <p class="text-base mb-4">จัดทำโดย นายจักรพงศ์ จันทวงศ์ โรงเรียนหางดงรัฐราษฎร์อุปถัมภ์</p>
        <a 
            href="https://hdr-info.vercel.app/" 
            target="_blank" 
            rel="noopener noreferrer"
            class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transition duration-300 ease-in-out transform hover:scale-105"
        >
            กลับเมนูหลัก
        </a>
    </div>

    <script>
        // Data for learning sequences extracted from your PDF documents
        const learningSequences = [
          {
            id: 'ฐานทรัพย์-1',
            title: '3.10 การสำรวจและจัดทำฐานทรัพยากรท้องถิ่น - ลำดับการเรียนรู้ที่ 1 เก็บข้อมูลพื้นฐานในท้องถิ่น',
            principle: 'รู้ทรัพยากร เห็นความหลาย รู้ระบบฐาน',
            essence: 'การสำรวจและจัดทำฐานทรัพยากรท้องถิ่น เป็นการเก็บรวบรวมข้อมูลทางด้านกายภาพ ชีวภาพ รวมทั้งวัฒนธรรมและภูมิปัญญา ของแต่ละท้องถิ่น ตั้งแต่อดีตถึงปัจจุบัน วิเคราะห์จัดทำเป็นระบบฐานข้อมูล',
            objectives: 'เพื่อให้ทราบข้อมูลพื้นฐานในท้องถิ่นของตน, เพื่อให้เห็นศักยภาพของท้องถิ่น, เพื่อให้เกิดทักษะในการสอบถาม รวบรวมข้อมูลและเป็นส่วนหนึ่งของชุมชน',
            process: 'โรงเรียนประสานงานและดำเนินงานร่วมกับองค์กรปกครองส่วนท้องถิ่น, การสำรวจเก็บรวบรวมข้อมูล',
            expectedOutcomes: 'นักเรียนสามารถรวบรวมข้อมูลพื้นฐานของท้องถิ่นได้, เข้าใจศักยภาพของท้องถิ่นตนเอง',
            keywords: ['ข้อมูลพื้นฐาน', 'ท้องถิ่น', 'ศักยภาพ', 'สอบถาม', 'รวบรวมข้อมูล', 'ชุมชน', 'กายภาพ', 'ชีวภาพ', 'วัฒนธรรม', 'ภูมิปัญญา', 'สำรวจ']
          },
          {
            id: 'ฐานทรัพย์-9',
            title: '3.10 การสำรวจและจัดทำฐานทรัพยากรท้องถิ่น - ลำดับการเรียนรู้ที่ 9 เก็บข้อมูลแหล่งทรัพยากรและโบราณคดีในท้องถิ่น',
            principle: 'รู้ทรัพยากร เห็นความหลาย รู้ระบบฐาน',
            essence: 'การสำรวจและจัดทำฐานทรัพยากรท้องถิ่น เป็นการเก็บรวบรวมข้อมูลทางด้านกายภาพ ชีวภาพ รวมทั้งวัฒนธรรมและภูมิปัญญา ของแต่ละท้องถิ่น ตั้งแต่อดีตถึงปัจจุบัน วิเคราะห์จัดทำเป็นระบบฐานข้อมูล',
            objectives: 'เพื่อให้ทราบข้อมูลแหล่งทรัพยากรและโบราณคดีในท้องถิ่น, เพื่อให้ทราบศักยภาพของแหล่งทรัพยากรและโบราณคดีในท้องถิ่น, เพื่อให้ตระหนักและอนุรักษ์ แหล่งทรัพยากรและโบราณคดีในท้องถิ่น',
            process: 'สำรวจแหล่งข้อมูล, กำหนดประเด็นคำถามก่อนสอบถามข้อมูล, สัมภาษณ์หรือสอบถามข้อมูลจากบุคคล (ผู้อาวุโส ผู้รู้), ใช้ใบงาน',
            expectedOutcomes: 'นักเรียนสามารถระบุและอธิบายแหล่งทรัพยากรและโบราณคดีในท้องถิ่นได้, ตระหนักถึงความสำคัญของการอนุรักษ์',
            keywords: ['แหล่งทรัพยากร', 'โบราณคดี', 'ท้องถิ่น', 'สำรวจ', 'อนุรักษ์', 'ประวัติ', 'ความสำคัญ', 'ธรรมชาติ', 'มนุษย์สร้าง', 'อุทยาน', 'น้ำตก', 'สวนพฤกษศาสตร์']
          },
          {
            id: 'อปก1-1',
            title: '3.2.1 องค์ประกอบที่ 1 การจัดทำป้ายชื่อพรรณไม้ - ลำดับการเรียนรู้ที่ 1 กำหนดพื้นที่ศึกษา',
            principle: 'รู้ชื่อ รู้ลักษณ์ รู้จัก',
            essence: 'การจัดทำป้ายชื่อพรรณไม้โดยการเรียนรู้การกำหนดพื้นที่ศึกษา สำรวจและจัดทำผังพรรณไม้ แล้วศึกษาพรรณไม้ ทำตัวอย่างพรรณไม้ นำข้อมูลมาทำทะเบียนพรรณไม้ ทำและติดแสดงป้ายชื่อพรรณไม้สมบูรณ์ นำไปสู่การรู้ชื่อ รู้ลักษณะต่าง ๆ รวมถึงรู้จักการใช้ประโยชน์ของพืช',
            objectives: 'เพื่อรู้พื้นที่ศึกษา, เพื่อรู้ขอบเขตพื้นที่ศึกษา, เพื่อรู้ศักยภาพของพื้นที่ศึกษา',
            process: 'เรียนรู้การกำหนดพื้นที่ศึกษา, กำหนดขอบเขต, สำรวจ, บันทึกข้อมูล',
            expectedOutcomes: 'นักเรียนสามารถกำหนดและสำรวจพื้นที่ศึกษาได้',
            keywords: ['พื้นที่ศึกษา', 'ขอบเขต', 'ศักยภาพ', 'สำรวจ', 'บันทึก', 'ป้ายชื่อพรรณไม้', 'ผังพรรณไม้']
          },
          {
            id: 'อปก1-2',
            title: '3.2.1 องค์ประกอบที่ 1 การจัดทำป้ายชื่อพรรณไม้ - ลำดับการเรียนรู้ที่ 2 สำรวจพรรณไม้ในพื้นที่ศึกษา',
            principle: 'รู้ชื่อ รู้ลักษณ์ รู้จัก',
            essence: 'การจัดทำป้ายชื่อพรรณไม้โดยการเรียนรู้การกำหนดพื้นที่ศึกษา สำรวจและจัดทำผังพรรณไม้ แล้วศึกษาพรรณไม้ ทำตัวอย่างพรรณไม้ นำข้อมูลมาทำทะเบียนพรรณไม้ ทำและติดแสดงป้ายชื่อพรรณไม้สมบูรณ์ นำไปสู่การรู้ชื่อ รู้ลักษณะต่าง ๆ รวมถึงรู้จักการใช้ประโยชน์ของพืช',
            objectives: 'เพื่อรู้พรรณไม้ในพื้นที่ศึกษา, เพื่อรู้ชนิดพรรณไม้ในพื้นที่ศึกษา',
            process: 'เรียนรู้การสำรวจพรรณไม้, สำรวจ, บันทึกข้อมูล, จัดทำทะเบียนพรรณไม้',
            expectedOutcomes: 'นักเรียนสามารถสำรวจและระบุชนิดพรรณไม้ในพื้นที่ได้',
            keywords: ['พรรณไม้', 'สำรวจ', 'ชนิด', 'ทะเบียน', 'ป้ายชื่อพรรณไม้']
          },
          {
            id: 'อปก1-6',
            title: '3.2.1 องค์ประกอบที่ 1 การจัดทำป้ายชื่อพรรณไม้ - ลำดับการเรียนรู้ที่ 6 ศึกษาและบันทึกลักษณะทางพฤกษศาสตร์',
            principle: 'รู้ชื่อ รู้ลักษณ์ รู้จัก',
            essence: 'การจัดทำป้ายชื่อพรรณไม้โดยการเรียนรู้การกำหนดพื้นที่ศึกษา สำรวจและจัดทำผังพรรณไม้ แล้วศึกษาพรรณไม้ ทำตัวอย่างพรรณไม้ นำข้อมูลมาทำทะเบียนพรรณไม้ ทำและติดแสดงป้ายชื่อพรรณไม้สมบูรณ์ นำไปสู่การรู้ชื่อ รู้ลักษณะต่าง ๆ รวมถึงรู้จักการใช้ประโยชน์ของพืช',
            objectives: 'เพื่อรู้ลักษณะทางพฤกษศาสตร์, เพื่อรู้ประโยชน์ของพรรณไม้',
            process: 'เรียนรู้ลักษณะทางพฤกษศาสตร์ (ราก, ลำต้น, ใบ, ดอก, ผล, เมล็ด), บันทึกข้อมูล',
            expectedOutcomes: 'นักเรียนสามารถอธิบายลักษณะทางพฤกษศาสตร์และประโยชน์ของพรรณไม้ได้',
            keywords: ['พฤกษศาสตร์', 'ลักษณะ', 'ราก', 'ลำต้น', 'ใบ', 'ดอก', 'ผล', 'เมล็ด', 'ประโยชน์', 'พรรณไม้']
          },
          {
            id: 'อปก1-10',
            title: '3.2.1 องค์ประกอบที่ 1 การจัดทำป้ายชื่อพรรณไม้ - ลำดับการเรียนรู้ที่ 10 จัดทำทะเบียนพรรณไม้และป้ายชื่อพรรณไม้สมบูรณ์',
            principle: 'รู้ชื่อ รู้ลักษณ์ รู้จัก',
            essence: 'การจัดทำป้ายชื่อพรรณไม้โดยการเรียนรู้การกำหนดพื้นที่ศึกษา สำรวจและจัดทำผังพรรณไม้ แล้วศึกษาพรรณไม้ ทำตัวอย่างพรรณไม้ นำข้อมูลมาทำทะเบียนพรรณไม้ ทำและติดแสดงป้ายชื่อพรรณไม้สมบูรณ์ นำไปสู่การรู้ชื่อ รู้ลักษณะต่าง ๆ รวมถึงรู้จักการใช้ประโยชน์ของพืช',
            objectives: 'เพื่อรู้การจัดทำทะเบียนพรรณไม้, เพื่อรู้การจัดทำป้ายชื่อพรรณไม้สมบูรณ์',
            process: 'เรียนรู้การจัดทำทะเบียนพรรณไม้ (ข้อมูลพืช, รหัส, ภาพ), จัดทำป้ายชื่อพรรณไม้สมบูรณ์ (ชื่อวิทยาศาสตร์, ชื่อวงศ์, ชื่อสามัญ, ชื่อพื้นบ้าน, ประโยชน์, รหัส)',
            expectedOutcomes: 'นักเรียนสามารถจัดทำทะเบียนพรรณไม้และป้ายชื่อพรรณไม้ได้',
            keywords: ['ทะเบียนพรรณไม้', 'ป้ายชื่อ', 'ชื่อวิทยาศาสตร์', 'ชื่อวงศ์', 'ชื่อสามัญ', 'ประโยชน์', 'รหัส', 'พรรณไม้', 'จำแนกชนิด']
          },
          {
            id: 'อปก2-1',
            title: '3.2.2 องค์ประกอบที่ 2 การรวบรวมพรรณไม้เข้าปลูกในโรงเรียน - ลำดับการเรียนรู้ที่ 1 ศึกษาข้อมูลจากผังพรรณไม้เดิมและศึกษาธรรมชาติของพรรณไม้',
            principle: 'คลุกคลี เห็นคุณ สุนทรีย์',
            essence: 'การรวบรวมพรรณไม้เข้าปลูกในโรงเรียน จัดให้มีการศึกษาธรรมชาติ สำรวจสภาพภูมิศาสตร์ของพื้นที่ตามผังพรรณไม้ เพื่อกำหนดชนิด การใช้ประโยชน์ในพื้นที่ รวมถึงการเลือกวัสดุที่ใช้สำหรับปลูก และจัดทำผังภูมิทัศน์แสดงรายละเอียดการจัดหาพรรณไม้ การเพาะปลูก จากนั้นทำการศึกษาพรรณไม้หลังการปลูกโดยการบันทึกการดูแลรักษา การเปลี่ยนแปลงของความสัมพันธ์ระหว่างปัจจัย',
            objectives: 'เพื่อรู้ข้อมูลของพื้นที่ศึกษาจากผังพรรณไม้, เพื่อรู้ธรรมชาติของพรรณไม้',
            process: 'เรียนรู้ข้อมูลผังพรรณไม้เดิม, ศึกษาธรรมชาติพรรณไม้ (รูปลักษณ์, คุณสมบัติ, พฤติกรรม, ปัจจัยที่เกี่ยวข้อง)',
            expectedOutcomes: 'นักเรียนเข้าใจข้อมูลผังพรรณไม้และธรรมชาติของพรรณไม้',
            keywords: ['ผังพรรณไม้', 'ธรรมชาติพรรณไม้', 'รูปลักษณ์', 'คุณสมบัติ', 'พฤติกรรม', 'ปัจจัย', 'ปลูกพืช', 'ภูมิทัศน์']
          },
          {
            id: 'อปก2-2',
            title: '3.2.2 องค์ประกอบที่ 2 การรวบรวมพรรณไม้เข้าปลูกในโรงเรียน - ลำดับการเรียนรู้ที่ 2 สำรวจ ศึกษา วิเคราะห์สภาพพื้นที่',
            principle: 'คลุกคลี เห็นคุณ สุนทรีย์',
            essence: 'การรวบรวมพรรณไม้เข้าปลูกในโรงเรียน จัดให้มีการศึกษาธรรมชาติ สำรวจสภาพภูมิศาสตร์ของพื้นที่ตามผังพรรณไม้ เพื่อกำหนดชนิด การใช้ประโยชน์ในพื้นที่ รวมถึงการเลือกวัสดุที่ใช้สำหรับปลูก และจัดทำผังภูมิทัศน์แสดงรายละเอียดการจัดหาพรรณไม้ การเพาะปลูก จากนั้นทำการศึกษาพรรณไม้หลังการปลูกโดยการบันทึกการดูแลรักษา การเปลี่ยนแปลงของความสัมพันธ์ระหว่างปัจจัย',
            objectives: 'เพื่อรู้สภาพพื้นที่, เพื่อรู้ศักยภาพของสภาพพื้นที่, เพื่อรู้แนวทางการพัฒนาสภาพพื้นที่',
            process: 'เรียนรู้การสำรวจ, สำรวจ, บันทึก, วิเคราะห์',
            expectedOutcomes: 'นักเรียนสามารถสำรวจ วิเคราะห์ และเสนอแนวทางพัฒนาสภาพพื้นที่ได้',
            keywords: ['สภาพพื้นที่', 'ศักยภาพ', 'พัฒนา', 'สำรวจ', 'วิเคราะห์', 'ภูมิศาสตร์', 'ปลูกพืช']
          },
          {
            id: 'อปก2-9',
            title: '3.2.2 องค์ประกอบที่ 2 การรวบรวมพรรณไม้เข้าปลูกในโรงเรียน - ลำดับการเรียนรู้ที่ 9 ศึกษาพรรณไม้หลังการปลูก',
            principle: 'คลุกคลี เห็นคุณ สุนทรีย์',
            essence: 'การรวบรวมพรรณไม้เข้าปลูกในโรงเรียน จัดให้มีการศึกษาธรรมชาติ สำรวจสภาพภูมิศาสตร์ของพื้นที่ตามผังพรรณไม้ เพื่อกำหนดชนิด การใช้ประโยชน์ในพื้นที่ รวมถึงการเลือกวัสดุที่ใช้สำหรับปลูก และจัดทำผังภูมิทัศน์แสดงรายละเอียดการจัดหาพรรณไม้ การเพาะปลูก จากนั้นทำการศึกษาพรรณไม้หลังการปลูกโดยการบันทึกการดูแลรักษา การเปลี่ยนแปลงของความสัมพันธ์ระหว่างปัจจัย',
            objectives: 'เพื่อรู้การดูแลรักษาพรรณไม้, เพื่อรู้การเปลี่ยนแปลงความสัมพันธ์ระหว่างปัจจัย',
            process: 'เรียนรู้การดูแลรักษา (การรดน้ำ, ใส่ปุ๋ย, พรวนดิน, กำจัดวัชพืช, โรค/แมลง), บันทึกการดูแล, บันทึกการเปลี่ยนแปลงความสัมพันธ์ระหว่างปัจจัย (พืช, สัตว์, ชีวภาพอื่น ๆ, กายภาพ: น้ำ, แสง, อากาศ, สิ่งปลูกสร้าง)',
            expectedOutcomes: 'นักเรียนสามารถดูแลรักษาพรรณไม้และเข้าใจความสัมพันธ์ระหว่างพืชกับปัจจัยแวดล้อม',
            keywords: ['ดูแลรักษา', 'การเปลี่ยนแปลง', 'ความสัมพันธ์', 'ปัจจัย', 'รดน้ำ', 'ปุ๋ย', 'วัชพืช', 'โรค', 'แมลง', 'สัตว์', 'ชีวภาพ', 'กายภาพ', 'พรรณไม้', 'ปลูก']
          },
          {
            id: 'อปก3-1',
            title: '3.2.3 องค์ประกอบที่ 3 การศึกษาข้อมูลด้านต่าง ๆ - ลำดับการเรียนรู้ที่ 1 ศึกษาพรรณไม้ในสวนพฤกษศาสตร์โรงเรียน (ก.7-003) ครบตามทะเบียนพรรณไม้',
            principle: 'รู้การวิเคราะห์ เห็นความต่าง รู้ความหลายหลาก',
            essence: 'การศึกษาข้อมูลด้านต่างๆ ทางด้านข้อมูลพื้นบ้าน ข้อมูลพรรณไม้ การสืบค้นข้อมูลด้านพฤกษศาสตร์ การศึกษาพรรณไม้ที่สนใจอย่างละเอียดทั้งโครงสร้างภายนอกและภายใน การกำหนดเรื่องที่จะเรียนรู้ในองค์ประกอบส่วนย่อยของพรรณไม้ที่สนใจ และเปรียบเทียบความต่างแต่ละเรื่องกับพืชชนิดเดียวกัน โดยมีการตรวจสอบผลงานเป็นระยะ',
            objectives: 'เพื่อรู้ข้อมูลพื้นบ้าน, เพื่อรู้ข้อมูลพรรณไม้, เพื่อรู้ข้อมูลพฤกษศาสตร์',
            process: 'มีส่วนร่วมของผู้ศึกษา, ศึกษาข้อมูลพื้นบ้าน, ศึกษาข้อมูลพรรณไม้, สรุปลักษณะและข้อมูลพรรณไม้, สืบค้นข้อมูลพฤกษศาสตร์, บันทึกข้อมูลเพิ่มเติม, ตรวจสอบผลงาน, ความเป็นระเบียบ ความตั้งใจ',
            expectedOutcomes: 'นักเรียนสามารถรวบรวมและสรุปข้อมูลเกี่ยวกับพรรณไม้จากแหล่งต่างๆ ได้',
            keywords: ['ข้อมูลพื้นบ้าน', 'พรรณไม้', 'พฤกษศาสตร์', 'สืบค้น', 'บันทึก', 'ตรวจสอบ', 'ทะเบียนพรรณไม้', 'วิเคราะห์']
          },
          {
            id: 'อปก3-2',
            title: '3.2.3 องค์ประกอบที่ 3 การศึกษาข้อมูลด้านต่าง ๆ - ลำดับการเรียนรู้ที่ 2 ศึกษาพรรณไม้ที่สนใจ',
            principle: 'รู้การวิเคราะห์ เห็นความต่าง รู้ความหลายหลาก',
            essence: 'การศึกษาข้อมูลด้านต่างๆ ทางด้านข้อมูลพื้นบ้าน ข้อมูลพรรณไม้ การสืบค้นข้อมูลด้านพฤกษศาสตร์ การศึกษาพรรณไม้ที่สนใจอย่างละเอียดทั้งโครงสร้างภายนอกและภายใน การกำหนดเรื่องที่จะเรียนรู้ในองค์ประกอบส่วนย่อยของพรรณไม้ที่สนใจ และเปรียบเทียบความต่างแต่ละเรื่องกับพืชชนิดเดียวกัน โดยมีการตรวจสอบผลงานเป็นระยะ',
            objectives: 'เพื่อรู้ลักษณะภายนอก ภายในของพืชแต่ละส่วนโดยละเอียด, เพื่อรู้เรื่องที่จะเรียนรู้ในแต่ละส่วนของพืช, เพื่อรู้ความต่างในแต่ละเรื่อง ในชนิดเดียวกัน',
            process: 'ศึกษาลักษณะภายนอก ภายในของพืชแต่ละส่วนโดยละเอียด, กำหนดเรื่องที่จะเรียนรู้ในแต่ละส่วนของพืช, เรียนรู้แต่ละเรื่อง แต่ละส่วนขององค์ประกอบย่อย, นำข้อมูลมาเปรียบเทียบความต่างในแต่ละเรื่อง ในชนิดเดียวกัน',
            expectedOutcomes: 'นักเรียนสามารถศึกษาโครงสร้างพืชได้อย่างละเอียดและเปรียบเทียบความแตกต่างได้',
            keywords: ['พรรณไม้', 'ลักษณะภายนอก', 'ลักษณะภายใน', 'โครงสร้าง', 'เปรียบเทียบ', 'สัณฐานวิทยา', 'กายวิภาควิทยา', 'วิเคราะห์']
          },
          {
            id: 'อปก4-1',
            title: '3.2.4 องค์ประกอบที่ 4 การรายงานผลการเรียนรู้ - ลำดับการเรียนรู้ที่ 1 รวบรวมผลการเรียนรู้',
            principle: 'รู้สาระ รู้สรุป รู้สื่อ',
            essence: 'การรายงานผลการเรียนรู้ ที่ได้จากการรวบรวมผลการเรียนรู้ คัดแยกสาระสำคัญ จัดหมวดหมู่ จัดระบบข้อมูล และการเขียนรายงานในรูปแบบวิชาการและแบบบูรณา โดยใช้ภาษาสื่อที่กระชับ ได้ใจความ รวมถึงวิธีการรายงานในรูปแบบต่าง ๆ ทั้งแบบเอกสารแบบบรรยาย แบบศิลปะ และแบบนิทรรศการ เป็นต้น',
            objectives: 'เพื่อรู้การรวบรวมผลการเรียนรู้',
            process: 'เรียนรู้การรวบรวมผลการเรียนรู้, รวบรวม',
            expectedOutcomes: 'นักเรียนสามารถรวบรวมผลการเรียนรู้ได้อย่างเป็นระบบ',
            keywords: ['รวบรวม', 'ผลการเรียนรู้', 'รายงานผล', 'สรุป', 'สื่อ']
          },
          {
            id: 'อปก4-3',
            title: '3.2.4 องค์ประกอบที่ 4 การรายงานผลการเรียนรู้ - ลำดับการเรียนรู้ที่ 3 สรุปและเรียบเรียง',
            principle: 'รู้สาระ รู้สรุป รู้สื่อ',
            essence: 'การรายงานผลการเรียนรู้ ที่ได้จากการรวบรวมผลการเรียนรู้ คัดแยกสาระสำคัญ จัดหมวดหมู่ จัดระบบข้อมูล และการเขียนรายงานในรูปแบบวิชาการและแบบบูรณา โดยใช้ภาษาสื่อที่กระชับ ได้ใจความ รวมถึงวิธีการรายงานในรูปแบบต่าง ๆ ทั้งแบบเอกสารแบบบรรยาย แบบศิลปะ และแบบนิทรรศการ เป็นต้น',
            objectives: 'เพื่อรู้การสรุปและเรียบเรียง',
            process: 'เรียนรู้การสรุปและเรียบเรียง',
            expectedOutcomes: 'นักเรียนสามารถสรุปและเรียบเรียงข้อมูลได้อย่างมีประสิทธิภาพ',
            keywords: ['สรุป', 'เรียบเรียง', 'รายงานผล', 'สื่อ']
          },
          {
            id: 'อปก4-6',
            title: '3.2.4 องค์ประกอบที่ 4 การรายงานผลการเรียนรู้ - ลำดับการเรียนรู้ที่ 6 เรียนรู้วิธีการรายงานผล',
            principle: 'รู้สาระ รู้สรุป รู้สื่อ',
            essence: 'การรายงานผลการเรียนรู้ ที่ได้จากการรวบรวมผลการเรียนรู้ คัดแยกสาระสำคัญ จัดหมวดหมู่ จัดระบบข้อมูล และการเขียนรายงานในรูปแบบวิชาการและแบบบูรณา โดยใช้ภาษาสื่อที่กระชับ ได้ใจความ รวมถึงวิธีการรายงานในรูปแบบต่าง ๆ ทั้งแบบเอกสารแบบบรรยาย แบบศิลปะ และแบบนิทรรศการ เป็นต้น',
            objectives: 'เพื่อรู้วิธีการรายงานผล',
            process: 'เรียนรู้วิธีการรายงานผล (เอกสาร, บรรยาย, ศิลปะ, นิทรรศการ)',
            expectedOutcomes: 'นักเรียนสามารถเลือกและใช้วิธีการรายงานผลที่เหมาะสมได้',
            keywords: ['รายงานผล', 'เอกสาร', 'บรรยาย', 'ศิลปะ', 'นิทรรศการ', 'สื่อ', 'นำเสนอ']
          },
          {
            id: 'อปก5-1',
            title: '3.2.5 องค์ประกอบที่ 5 การนำไปใช้ประโยชน์ทางการศึกษา - ลำดับการเรียนรู้ที่ 1 นำสวนพฤกษศาสตร์โรงเรียนบูรณาการสู่การเรียนการสอน',
            principle: 'นำองค์ความรู้ ที่เป็นวิทยาการ เผยแพร่เพื่อให้เกิดองค์ความรู้ใหม่',
            essence: 'การนำไปใช้ประโยชน์ทางการศึกษาโดยการบูรณาการสู่การเรียนการสอน การใช้สวนพฤกษศาสตร์โรงเรียนเป็นแหล่งเรียนรู้ บันทึกข้อมูล รวบรวมเป็นพิพิธภัณฑ์เฉพาะเรื่อง พิพิธภัณฑ์ธรรมชาติวิทยา รวมถึงการเผยแพร่องค์ความรู้ การใช้และพัฒนาแหล่งเรียนรู้อย่างต่อเนื่อง',
            objectives: 'เพื่อรู้การบูรณาการสู่การเรียนการสอน',
            process: 'จัดทำหลักสูตรและแผนการสอน, จัดเก็บผลการเรียนรู้',
            expectedOutcomes: 'นักเรียนและครูสามารถบูรณาการงานสวนพฤกษศาสตร์โรงเรียนเข้ากับการเรียนการสอนได้อย่างมีประสิทธิภาพ',
            keywords: ['บูรณาการ', 'เรียนการสอน', 'หลักสูตร', 'แผนการสอน', 'จัดเก็บผล', 'แหล่งเรียนรู้', 'เผยแพร่', 'องค์ความรู้']
          },
          {
            id: 'อปก5-2',
            title: '3.2.5 องค์ประกอบที่ 5 การนำไปใช้ประโยชน์ทางการศึกษา - ลำดับการเรียนรู้ที่ 2 เผยแพร่องค์ความรู้',
            principle: 'นำองค์ความรู้ ที่เป็นวิทยาการ เผยแพร่เพื่อให้เกิดองค์ความรู้ใหม่',
            essence: 'การนำไปใช้ประโยชน์ทางการศึกษาโดยการบูรณาการสู่การเรียนการสอน การใช้สวนพฤกษศาสตร์โรงเรียนเป็นแหล่งเรียนรู้ บันทึกข้อมูล รวบรวมเป็นพิพิธภัณฑ์เฉพาะเรื่อง พิพิธภัณฑ์ธรรมชาติวิทยา รวมถึงการเผยแพร่องค์ความรู้ การใช้และพัฒนาแหล่งเรียนรู้อย่างต่อเนื่อง',
            objectives: 'เพื่อรู้การเผยแพร่องค์ความรู้',
            process: 'บรรยาย (สนทนา, เสวนา, สัมมนา/อภิปราย), จัดแสดง (นิทรรศการ)',
            expectedOutcomes: 'นักเรียนสามารถเผยแพร่่องค์ความรู้ที่ได้จากการเรียนรู้ได้',
            keywords: ['เผยแพร่', 'องค์ความรู้', 'บรรยาย', 'จัดแสดง', 'นิทรรศการ', 'สนทนา', 'เสวนา', 'สัมมนา', 'อภิปราย']
          },
          {
            id: 'อปก5-3',
            title: '3.2.5 องค์ประกอบที่ 5 การนำไปใช้ประโยชน์ทางการศึกษา - ลำดับการเรียนรู้ที่ 3 จัดสร้างแหล่งเรียนรู้',
            principle: 'นำองค์ความรู้ ที่เป็นวิทยาการ เผยแพร่เพื่อให้เกิดองค์ความรู้ใหม่',
            essence: 'การนำไปใช้ประโยชน์ทางการศึกษาโดยการบูรณาการสู่การเรียนการสอน การใช้สวนพฤกษศาสตร์โรงเรียนเป็นแหล่งเรียนรู้ บันทึกข้อมูล รวบรวมเป็นพิพิธภัณฑ์เฉพาะเรื่อง พิพิธภัณฑ์ธรรมชาติวิทยา รวมถึงการเผยแพร่องค์ความรู้ การใช้และพัฒนาแหล่งเรียนรู้อย่างต่อเนื่อง',
            objectives: 'เพื่อรู้การจัดสร้างแหล่งเรียนรู้',
            process: 'จัดแสดงพิพิธภัณฑ์ (เฉพาะเรื่อง, ธรรมชาติวิทยา)',
            expectedOutcomes: 'นักเรียนสามารถมีส่วนร่วมในการจัดสร้างแหล่งเรียนรู้ เช่น พิพิธภัณฑ์',
            keywords: ['แหล่งเรียนรู้', 'พิพิธภัณฑ์', 'ธรรมชาติวิทยา', 'จัดสร้าง']
          },
          {
            id: 'สาระ1-1',
            title: '3.2.6 สาระการเรียนรู้ธรรมชาติแห่งชีวิต - ลำดับการเรียนรู้ที่ 1 สัมผัสเรียนรู้วงจรชีวิตของชีวภาพ',
            principle: 'รู้การเปลี่ยนแปลง รู้ความแตกต่าง รู้ชีวิต',
            essence: 'การเรียนรู้วงจรชีวิตของชีวภาพนั้น ๆ ได้ข้อมูลการเปลี่ยนแปลงและความแตกต่างด้านรูปลักษณ์ คุณสมบัติ และพฤติกรรม แล้วนำมาเปรียบเทียบตนเองและผู้อื่นกับชีวภาพรอบกาย เพื่อประยุกต์ใช้ในการดำเนินชีวิต',
            objectives: 'เพื่อรู้วงจรชีวิตของชีวภาพ',
            process: 'เรียนรู้วงจรชีวิตของชีวภาพ (ด้านรูปลักษณ์, คุณสมบัติ, พฤติกรรม)',
            expectedOutcomes: 'นักเรียนเข้าใจวงจรชีวิตของชีวภาพและนำมาประยุกต์ใช้ในชีวิตได้',
            keywords: ['วงจรชีวิต', 'ชีวภาพ', 'รูปลักษณ์', 'คุณสมบัติ', 'พฤติกรรม', 'การเปลี่ยนแปลง', 'พืช', 'สัตว์', 'นิเวศวิทยา', 'การเจริญเติบโต', 'สังเคราะห์ด้วยแสง', 'ชีวิต']
          },
          {
            id: 'สาระ2-5',
            title: '3.2.7 สาระการเรียนรู้ สรรพสิ่งล้วนพันเกี่ยว - ลำดับการเรียนรู้ที่ 5 เรียนรู้ธรรมชาติของความพันเกี่ยวระหว่างปัจจัย',
            principle: 'รู้สัมพันธ์ รู้ผูกพัน รู้ดุลยภาพ',
            essence: 'การวิเคราะห์องค์ความรู้ธรรมชาติของปัจจัยหลัก การเรียนรู้ธรรมชาติของปัจจัยที่เข้ามาเกี่ยวข้อง การเรียนรู้ธรรมชาติของความพันเกี่ยวระหว่างปัจจัย การวิเคราะห์สัมพันธภาพระหว่างปัจจัย เพื่อเข้าใจดุลยภาพและความพันเกี่ยวของสรรพสิ่ง',
            objectives: 'เพื่อรู้ความสัมพันธ์และสัมพันธภาพ, เพื่อรู้ความผูกพัน',
            process: 'เรียนรู้ วิเคราะห์ให้เห็นความสัมพันธ์และสัมพันธภาพ, เรียนรู้ วิเคราะห์ให้เห็นความผูกพัน',
            expectedOutcomes: 'นักเรียนเข้าใจความสัมพันธ์และดุลยภาพของสรรพสิ่งในระบบนิเวศ',
            keywords: ['ความสัมพันธ์', 'พันเกี่ยว', 'ปัจจัย', 'ดุลยภาพ', 'สัมพันธภาพ', 'ผูกพัน', 'ชีวภาพ', 'กายภาพ', 'ระบบนิเวศ', 'สิ่งมีชีวิต', 'สิ่งแวดล้อม']
          },
          {
            id: 'สาระ3-1',
            title: '3.2.8 สาระการเรียนรู้ประโยชน์แท้แก่มหาชน - ลำดับการเรียนรู้ที่ 1 เรียนรู้การวิเคราะห์ศักยภาพของปัจจัยศึกษา',
            principle: 'รู้ศักยภาพ รู้จินตนาการ รู้ประโยชน์',
            essence: 'การวิเคราะห์ศักยภาพของปัจจัยศึกษา จินตนาการเห็นคุณ สรรสร้างวิธีการ เพื่อประโยชน์แท้แก่มหาชน',
            objectives: 'เพื่อรู้การวิเคราะห์ศักยภาพด้านรูปลักษณ์, เพื่อรู้การวิเคราะห์ศักยภาพด้านคุณสมบัติ, เพื่อรู้การวิเคราะห์ศักยภาพด้านพฤติกรรม',
            process: 'พิจารณาศักยภาพด้านรูปลักษณ์, วิเคราะห์ศักยภาพด้านคุณสมบัติ, จินตนาการศักยภาพด้านพฤติกรรม',
            expectedOutcomes: 'นักเรียนสามารถวิเคราะห์ศักยภาพของสิ่งต่างๆ และเห็นคุณค่าได้',
            keywords: ['ศักยภาพ', 'รูปลักษณ์', 'คุณสมบัติ', 'พฤติกรรม', 'วิเคราะห์', 'ประโยชน์', 'จินตนาการ', 'สร้างสรรค์']
          },
          {
            id: 'สาระ3-3',
            title: '3.2.8 สาระการเรียนรู้ประโยชน์แท้แก่มหาชน - ลำดับการเรียนรู้ที่ 3 สรรค์สร้างวิธีการ',
            principle: 'รู้ศักยภาพ รู้จินตนาการ รู้ประโยชน์',
            essence: 'การวิเคราะห์ศักยภาพของปัจจัยศึกษา จินตนาการเห็นคุณ สรรสร้างวิธีการ เพื่อประโยชน์แท้แก่มหาชน',
            objectives: 'เพื่อรู้การพิจารณาคุณ, เพื่อรู้วิธีการสร้างแนวคิด แนวทาง วิธีการ',
            process: 'พิจารณาคุณที่เกิดจากจินตนาการ, สร้างแนวคิด แนวทาง วิธีการ',
            expectedOutcomes: 'นักเรียนสามารถสร้างแนวคิดและวิธีการใหม่ๆ เพื่อประโยชน์ส่วนรวมได้',
            keywords: ['สร้างสรรค์', 'แนวคิด', 'แนวทาง', 'วิธีการ', 'จินตนาการ', 'ประโยชน์', 'มหาชน']
          }
        ];

        // Get references to DOM elements
        const integrationForm = document.getElementById('integrationForm');
        const gradeLevelSelect = document.getElementById('gradeLevel');
        const subjectSelect = document.getElementById('subject');
        const topicTextarea = document.getElementById('topic');
        const submitButton = document.getElementById('submitButton');
        const buttonText = document.getElementById('buttonText');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const errorMessage = document.getElementById('errorMessage');
        const resultsContainer = document.getElementById('resultsContainer');
        const displayGradeLevel = document.getElementById('displayGradeLevel');
        const displaySubject = document.getElementById('displaySubject');
        const displayTopic = document.getElementById('displayTopic');
        const resultsContent = document.getElementById('resultsContent');

        // Function to handle form submission
        integrationForm.addEventListener('submit', async (e) => {
            e.preventDefault(); // Prevent default form submission

            // Reset UI state
            errorMessage.classList.add('hidden');
            resultsContainer.classList.add('hidden');
            resultsContent.innerHTML = ''; // Clear previous results

            // Get input values
            const gradeLevel = gradeLevelSelect.value;
            const subject = subjectSelect.value;
            const topic = topicTextarea.value;

            // Basic validation
            if (!gradeLevel || !subject || !topic) {
                errorMessage.textContent = 'กรุณากรอกข้อมูลให้ครบถ้วนทุกช่อง';
                errorMessage.classList.remove('hidden');
                return;
            }

            // Show loading state
            submitButton.disabled = true;
            buttonText.classList.add('hidden');
            loadingSpinner.classList.remove('hidden');

            try {
                let chatHistory = [];
                const prompt = `คุณคือผู้ช่วย AI สำหรับการบูรณาการกิจกรรมสวนพฤกษศาสตร์โรงเรียนเข้ากับการเรียนการสอน
จากข้อมูลที่ผู้ใช้ป้อนสำหรับ 'ระดับชั้น', 'วิชาที่สอน', และ 'เรื่องที่สอน' และรายการ 'ลำดับการเรียนรู้' ที่มีอยู่
โปรดระบุลำดับการเรียนรู้ที่เกี่ยวข้องมากที่สุด 3 อันดับแรก
สำหรับแต่ละ 3 อันดับแรก โปรดระบุเหตุผลโดยละเอียดสำหรับความเหมาะสม แนวทางการสอนที่ครอบคลุม และขั้นตอนการสอนแบบทีละขั้นตอน

ข้อมูลที่ผู้ใช้ป้อน:
ระดับชั้น: ${gradeLevel}
วิชาที่สอน: ${subject}
เรื่องที่สอน: ${topic}

ลำดับการเรียนรู้ที่มีอยู่ (รูปแบบ JSON array):
${JSON.stringify(learningSequences)}

รูปแบบผลลัพธ์ (JSON Array ของ Objects):
[
  {
    "id": "...", // รหัสของลำดับการเรียนรู้ที่เลือก
    "reason": "...", // เหตุผลโดยละเอียดสำหรับความเหมาะสม (เป็นภาษาไทย)
    "teachingApproach": "...", // แนวทางการสอนที่ครอบคลุม (เป็นภาษาไทย)
    "teachingSteps": "..." // ขั้นตอนการสอนแบบทีละขั้นตอน (เป็นภาษาไทย, ใช้ \\n สำหรับขึ้นบรรทัดใหม่)
  }
  // ... สูงสุด 2 ผลลัพธ์เพิ่มเติม
]
`;

                chatHistory.push({ role: "user", parts: [{ text: prompt }] });

                const payload = {
                    contents: chatHistory,
                    generationConfig: {
                        responseMimeType: "application/json",
                        responseSchema: {
                            type: "ARRAY",
                            items: {
                                type: "OBJECT",
                                properties: {
                                    "id": { "type": "STRING" },
                                    "reason": { "type": "STRING" },
                                    "teachingApproach": { "type": "STRING" },
                                    "teachingSteps": { "type": "STRING" }
                                },
                                required: ["id", "reason", "teachingApproach", "teachingSteps"]
                            }
                        }
                    }
                };

                const apiKey = ""; // Leave this as-is. Canvas will provide the API key at runtime.
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const json = result.candidates[0].content.parts[0].text;
                    const parsedJson = JSON.parse(json);

                    // Display input values in the results section
                    displayGradeLevel.textContent = gradeLevel;
                    displaySubject.textContent = subject;
                    displayTopic.textContent = topic;

                    // Generate and append results to the DOM
                    parsedJson.forEach((llmResult, index) => {
                        const originalSeq = learningSequences.find(seq => seq.id === llmResult.id);
                        const title = originalSeq ? originalSeq.title : 'ไม่พบชื่อลำดับการเรียนรู้';
                        const principle = originalSeq ? originalSeq.principle : '';
                        const essence = originalSeq ? originalSeq.essence : '';
                        const objectives = originalSeq ? originalSeq.objectives : '';

                        const resultDiv = document.createElement('div');
                        resultDiv.className = 'bg-purple-50 p-6 rounded-lg shadow-md mb-8 border-l-4 border-purple-500';
                        resultDiv.innerHTML = `
                            <h3 class="text-xl sm:text-2xl font-bold text-purple-800 mb-4">
                                อันดับที่ ${index + 1}: ${title}
                            </h3>
                            <p class="text-gray-700 mb-3">
                                <span class="font-semibold">หลักการ:</span> ${principle}
                            </p>
                            <p class="text-gray-700 mb-3">
                                <span class="font-semibold">สาระสำคัญ:</span> ${essence}
                            </p>
                            <p class="text-gray-700 mb-4">
                                <span class="font-semibold">วัตถุประสงค์:</span> ${objectives}
                            </p>

                            <h4 class="text-lg font-semibold text-purple-700 mb-2">เหตุผล:</h4>
                            <p class="text-gray-700 mb-4">${llmResult.reason}</p>

                            <h4 class="text-lg font-semibold text-purple-700 mb-2">แนวทางการสอน:</h4>
                            <p class="text-gray-700 mb-4">${llmResult.teachingApproach}</p>

                            <h4 class="text-lg font-semibold text-purple-700 mb-2">ขั้นตอนการสอน:</h4>
                            <div class="prose prose-purple max-w-none text-gray-700">
                                <p>${llmResult.teachingSteps.replace(/\n/g, '<br/>')}</p>
                            </div>
                        `;
                        resultsContent.appendChild(resultDiv);
                    });
                    resultsContainer.classList.remove('hidden'); // Show results section
                } else {
                    errorMessage.textContent = 'ไม่สามารถประมวลผลคำตอบได้ กรุณาลองใหม่อีกครั้ง';
                    errorMessage.classList.remove('hidden');
                    console.error('Unexpected API response structure:', result);
                }
            } catch (err) {
                errorMessage.textContent = 'เกิดข้อผิดพลาดในการเชื่อมต่อ AI: ' + err.message;
                errorMessage.classList.remove('hidden');
                console.error('API call error:', err);
            } finally {
                // Hide loading state
                submitButton.disabled = false;
                buttonText.classList.remove('hidden');
                loadingSpinner.classList.add('hidden');
            }
        });
    </script>
</body>
</html>
